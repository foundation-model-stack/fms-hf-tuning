dataprocessor:
    type: default
    chat_template_base64: 'eyUtIGlmIG1lc3NhZ2VzWzBdWydyb2xlJ10gPT0gJ3N5c3RlbScgJX0KICAgIHslLSBzZXQgc3lzdGVtX21lc3NhZ2UgPSBtZXNzYWdlc1swXVsnY29udGVudCddICV9CiAgICB7JS0gc2V0IGxvb3BfbWVzc2FnZXMgPSBtZXNzYWdlc1sxOl0gJX0KeyUtIGVsc2UgJX0KICAgIHslLSBzZXQgc3lzdGVtX21lc3NhZ2UgPSAiS25vd2xlZGdlIEN1dG9mZiBEYXRlOiBBcHJpbCAyMDI0LlxuVG9kYXkncyBEYXRlOiAiICsgc3RyZnRpbWVfbm93KCclQiAlZCwgJVknKSArICIuXG5Zb3UgYXJlIEdyYW5pdGUsIGRldmVsb3BlZCBieSBJQk0uIiAlfQogICAgeyUtIGlmIHRvb2xzIGFuZCBkb2N1bWVudHMgJX0KICAgICAgICB7JS0gc2V0IHN5c3RlbV9tZXNzYWdlID0gc3lzdGVtX21lc3NhZ2UgKyAiIFlvdSBhcmUgYSBoZWxwZnVsIEFJIGFzc2lzdGFudCB3aXRoIGFjY2VzcyB0byB0aGUgZm9sbG93aW5nIHRvb2xzLiBXaGVuIGEgdG9vbCBpcyByZXF1aXJlZCB0byBhbnN3ZXIgdGhlIHVzZXIncyBxdWVyeSwgcmVzcG9uZCB3aXRoIDx8dG9vbF9jYWxsfD4gZm9sbG93ZWQgYnkgYSBKU09OIGxpc3Qgb2YgdG9vbHMgdXNlZC4gSWYgYSB0b29sIGRvZXMgbm90IGV4aXN0IGluIHRoZSBwcm92aWRlZCBsaXN0IG9mIHRvb2xzLCBub3RpZnkgdGhlIHVzZXIgdGhhdCB5b3UgZG8gbm90IGhhdmUgdGhlIGFiaWxpdHkgdG8gZnVsZmlsbCB0aGUgcmVxdWVzdC5cblxuV3JpdGUgdGhlIHJlc3BvbnNlIHRvIHRoZSB1c2VyJ3MgaW5wdXQgYnkgc3RyaWN0bHkgYWxpZ25pbmcgd2l0aCB0aGUgZmFjdHMgaW4gdGhlIHByb3ZpZGVkIGRvY3VtZW50cy4gSWYgdGhlIGluZm9ybWF0aW9uIG5lZWRlZCB0byBhbnN3ZXIgdGhlIHF1ZXN0aW9uIGlzIG5vdCBhdmFpbGFibGUgaW4gdGhlIGRvY3VtZW50cywgaW5mb3JtIHRoZSB1c2VyIHRoYXQgdGhlIHF1ZXN0aW9uIGNhbm5vdCBiZSBhbnN3ZXJlZCBiYXNlZCBvbiB0aGUgYXZhaWxhYmxlIGRhdGEuIiAlfQogICAgeyUtIGVsaWYgdG9vbHMgJX0KICAgICAgICB7JS0gc2V0IHN5c3RlbV9tZXNzYWdlID0gc3lzdGVtX21lc3NhZ2UgKyAiIFlvdSBhcmUgYSBoZWxwZnVsIEFJIGFzc2lzdGFudCB3aXRoIGFjY2VzcyB0byB0aGUgZm9sbG93aW5nIHRvb2xzLiBXaGVuIGEgdG9vbCBpcyByZXF1aXJlZCB0byBhbnN3ZXIgdGhlIHVzZXIncyBxdWVyeSwgcmVzcG9uZCB3aXRoIDx8dG9vbF9jYWxsfD4gZm9sbG93ZWQgYnkgYSBKU09OIGxpc3Qgb2YgdG9vbHMgdXNlZC4gSWYgYSB0b29sIGRvZXMgbm90IGV4aXN0IGluIHRoZSBwcm92aWRlZCBsaXN0IG9mIHRvb2xzLCBub3RpZnkgdGhlIHVzZXIgdGhhdCB5b3UgZG8gbm90IGhhdmUgdGhlIGFiaWxpdHkgdG8gZnVsZmlsbCB0aGUgcmVxdWVzdC4iICV9CiAgICB7JS0gZWxpZiBkb2N1bWVudHMgJX0KICAgICAgICB7JS0gc2V0IHN5c3RlbV9tZXNzYWdlID0gc3lzdGVtX21lc3NhZ2UgKyAiIFdyaXRlIHRoZSByZXNwb25zZSB0byB0aGUgdXNlcidzIGlucHV0IGJ5IHN0cmljdGx5IGFsaWduaW5nIHdpdGggdGhlIGZhY3RzIGluIHRoZSBwcm92aWRlZCBkb2N1bWVudHMuIElmIHRoZSBpbmZvcm1hdGlvbiBuZWVkZWQgdG8gYW5zd2VyIHRoZSBxdWVzdGlvbiBpcyBub3QgYXZhaWxhYmxlIGluIHRoZSBkb2N1bWVudHMsIGluZm9ybSB0aGUgdXNlciB0aGF0IHRoZSBxdWVzdGlvbiBjYW5ub3QgYmUgYW5zd2VyZWQgYmFzZWQgb24gdGhlIGF2YWlsYWJsZSBkYXRhLiIgJX0KICAgIHslLSBlbHNlICV9CiAgICAgICAgeyUtIHNldCBzeXN0ZW1fbWVzc2FnZSA9IHN5c3RlbV9tZXNzYWdlICsgIiBZb3UgYXJlIGEgaGVscGZ1bCBBSSBhc3Npc3RhbnQuIiAlfSAgICAKICAgIHslLSBlbmRpZiAlfQogICAgeyUtIGlmICdjaXRhdGlvbnMnIGluIGNvbnRyb2xzIGFuZCBkb2N1bWVudHMgJX0KICAgICAgICB7JS0gc2V0IHN5c3RlbV9tZXNzYWdlID0gc3lzdGVtX21lc3NhZ2UgKyAnXG5cbkluIHlvdXIgcmVzcG9uc2UsIHVzZSB0aGUgc3ltYm9scyA8Y28+IGFuZCA8L2NvPiB0byBpbmRpY2F0ZSB3aGVuIGEgZmFjdCBjb21lcyBmcm9tIGEgZG9jdW1lbnQgaW4gdGhlIHNlYXJjaCByZXN1bHQsIGUuZyA8Y28+MDwvY28+IGZvciBhIGZhY3QgZnJvbSBkb2N1bWVudCAwLiBBZnRlcndhcmRzLCBsaXN0IGFsbCB0aGUgY2l0YXRpb25zIHdpdGggdGhlaXIgY29ycmVzcG9uZGluZyBkb2N1bWVudHMgaW4gYW4gb3JkZXJlZCBsaXN0LicgJX0KICAgIHslLSBlbmRpZiAlfQogICAgeyUtIGlmICdoYWxsdWNpbmF0aW9ucycgaW4gY29udHJvbHMgYW5kIGRvY3VtZW50cyAlfQogICAgICAgIHslLSBzZXQgc3lzdGVtX21lc3NhZ2UgPSBzeXN0ZW1fbWVzc2FnZSArICdcblxuRmluYWxseSwgYWZ0ZXIgdGhlIHJlc3BvbnNlIGlzIHdyaXR0ZW4sIGluY2x1ZGUgYSBudW1iZXJlZCBsaXN0IG9mIHNlbnRlbmNlcyBmcm9tIHRoZSByZXNwb25zZSB0aGF0IGFyZSBwb3RlbnRpYWxseSBoYWxsdWNpbmF0ZWQgYW5kIG5vdCBiYXNlZCBpbiB0aGUgZG9jdW1lbnRzLicgJX0KICAgIHslLSBlbmRpZiAlfQogICAgeyUtIHNldCBsb29wX21lc3NhZ2VzID0gbWVzc2FnZXMgJX0KeyUtIGVuZGlmICV9Cnt7LSAnPHxzdGFydF9vZl9yb2xlfD5zeXN0ZW08fGVuZF9vZl9yb2xlfD4nICsgc3lzdGVtX21lc3NhZ2UgKyAnPHxlbmRfb2ZfdGV4dHw+XG4nIH19CnslLSBpZiB0b29scyAlfQogICAge3stICc8fHN0YXJ0X29mX3JvbGV8PnRvb2xzPHxlbmRfb2Zfcm9sZXw+JyB9fQogICAge3stIHRvb2xzIHwgdG9qc29uKGluZGVudD00KSB9fQogICAge3stICc8fGVuZF9vZl90ZXh0fD5cbicgfX0KeyUtIGVuZGlmICV9CnslLSBpZiBkb2N1bWVudHMgJX0KICAgIHt7LSAnPHxzdGFydF9vZl9yb2xlfD5kb2N1bWVudHM8fGVuZF9vZl9yb2xlfD4nIH19CiAgICB7JS0gZm9yIGRvY3VtZW50IGluIGRvY3VtZW50cyAlfQogICAgICAgIHt7LSAnRG9jdW1lbnQgJyArIGxvb3AuaW5kZXgwIHwgc3RyaW5nICsgJ1xuJyB9fQogICAgICAgIHt7LSBkb2N1bWVudFsndGV4dCddIH19CiAgICAgICAgeyUtIGlmIG5vdCBsb29wLmxhc3QgJX0KICAgICAgICAgICAge3stICdcblxuJ319CiAgICAgICAgeyUtIGVuZGlmJX0KICAgIHslLSBlbmRmb3IgJX0KICAgIHt7LSAnPHxlbmRfb2ZfdGV4dHw+XG4nIH19CnslLSBlbmRpZiAlfQp7JS0gZm9yIG1lc3NhZ2UgaW4gbG9vcF9tZXNzYWdlcyAlfQogICAge3stICc8fHN0YXJ0X29mX3JvbGV8PicgKyBtZXNzYWdlWydyb2xlJ10gKyAnPHxlbmRfb2Zfcm9sZXw+JyArIG1lc3NhZ2VbJ2NvbnRlbnQnXSArICc8fGVuZF9vZl90ZXh0fD5cbicgfX0KICAgIHslLSBpZiBsb29wLmxhc3QgYW5kIGFkZF9nZW5lcmF0aW9uX3Byb21wdCAlfQogICAgICAgIHt7LSAnPHxzdGFydF9vZl9yb2xlfD5hc3Npc3RhbnQnIH19CiAgICAgICAgICAgIHslLSBpZiBjb250cm9scyAlfQogICAgICAgICAgICAgICAge3stICcgJyArIGNvbnRyb2xzIHwgdG9qc29uKCl9fQogICAgICAgICAgICB7JS0gZW5kaWYgJX0KICAgICAgICB7ey0gJzx8ZW5kX29mX3JvbGV8PicgfX0KICAgIHslLSBlbmRpZiAlfQp7JS0gZW5kZm9yICV9Cg=='
datasets:
  - name: dataset_1
    data_paths:
      - "FILE_PATH"
    data_handlers:
      - name: tokenize_and_apply_chat_template_with_masking
        arguments:
          remove_columns: all
          fn_kwargs:
            max_seq_length: 1024
            conversation_column: "messages"
  - name: dataset_2
    data_paths:
      - "FILE_PATH"
    data_handlers:
      - name: tokenize_and_apply_chat_template_with_masking
        arguments:
          remove_columns: all
          fn_kwargs:
            max_seq_length: 1024
            conversation_column: "messages"
  - name: dataset_3
    data_paths:
      - "FILE_PATH"
    data_handlers:
      - name: tokenize_and_apply_chat_template_with_masking
        arguments:
          remove_columns: all
          fn_kwargs:
            max_seq_length: 1024
            conversation_column: "messages"