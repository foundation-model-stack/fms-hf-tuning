/opt/conda/envs/tp/lib/python3.11/site-packages/transformers/training_args.py:1594: FutureWarning: `evaluation_strategy` is deprecated and will be removed in version 4.46 of 🤗 Transformers. Use `eval_strategy` instead
  warnings.warn(
/opt/conda/envs/tp/lib/python3.11/site-packages/transformers/training_args.py:1594: FutureWarning: `evaluation_strategy` is deprecated and will be removed in version 4.46 of 🤗 Transformers. Use `eval_strategy` instead
  warnings.warn(
You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
Loading checkpoint shards:   0%|          | 0/6 [00:00<?, ?it/s]Loading checkpoint shards:  17%|█▋        | 1/6 [00:00<00:01,  3.86it/s]Loading checkpoint shards:  33%|███▎      | 2/6 [00:00<00:01,  2.90it/s]Loading checkpoint shards:  50%|█████     | 3/6 [00:01<00:01,  2.76it/s]Loading checkpoint shards:  67%|██████▋   | 4/6 [00:01<00:00,  2.70it/s]You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
Loading checkpoint shards:   0%|          | 0/6 [00:00<?, ?it/s]Loading checkpoint shards:  17%|█▋        | 1/6 [00:00<00:00,  5.81it/s]Loading checkpoint shards:  83%|████████▎ | 5/6 [00:01<00:00,  2.70it/s]Loading checkpoint shards:  50%|█████     | 3/6 [00:00<00:00,  8.25it/s]Loading checkpoint shards: 100%|██████████| 6/6 [00:02<00:00,  2.89it/s]Loading checkpoint shards: 100%|██████████| 6/6 [00:02<00:00,  2.86it/s]
Loading checkpoint shards:  67%|██████▋   | 4/6 [00:00<00:00,  8.36it/s]Loading checkpoint shards: 100%|██████████| 6/6 [00:00<00:00,  9.50it/s]Loading checkpoint shards: 100%|██████████| 6/6 [00:00<00:00,  8.86it/s]
WARNING:sft_trainer.py:PAD token set to default, missing in tokenizer
WARNING:sft_trainer.py:PAD token set to default, missing in tokenizer
/opt/conda/envs/tp/lib/python3.11/site-packages/transformers/training_args.py:1594: FutureWarning: `evaluation_strategy` is deprecated and will be removed in version 4.46 of 🤗 Transformers. Use `eval_strategy` instead
  warnings.warn(
/opt/conda/envs/tp/lib/python3.11/site-packages/transformers/training_args.py:1594: FutureWarning: `evaluation_strategy` is deprecated and will be removed in version 4.46 of 🤗 Transformers. Use `eval_strategy` instead
  warnings.warn(
/opt/conda/envs/tp/lib/python3.11/site-packages/transformers/training_args.py:2077: FutureWarning: `--push_to_hub_token` is deprecated and will be removed in version 5 of 🤗 Transformers. Use `--hub_token` instead.
  warnings.warn(
/opt/conda/envs/tp/lib/python3.11/site-packages/transformers/training_args.py:2077: FutureWarning: `--push_to_hub_token` is deprecated and will be removed in version 5 of 🤗 Transformers. Use `--hub_token` instead.
  warnings.warn(
/opt/conda/envs/tp/lib/python3.11/site-packages/trl/trainer/sft_trainer.py:401: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `SFTTrainer.__init__`. Use `processing_class` instead.
  super().__init__(
/opt/conda/envs/tp/lib/python3.11/site-packages/trl/trainer/sft_trainer.py:401: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `SFTTrainer.__init__`. Use `processing_class` instead.
  super().__init__(
  0%|          | 0/100 [00:00<?, ?it/s]`use_cache=True` is incompatible with gradient checkpointing. Setting `use_cache=False`.
`use_cache=True` is incompatible with gradient checkpointing. Setting `use_cache=False`.
  1%|          | 1/100 [00:04<07:37,  4.62s/it]                                                 1%|          | 1/100 [00:04<07:37,  4.62s/it]  2%|▏         | 2/100 [00:07<06:02,  3.70s/it]                                                 2%|▏         | 2/100 [00:07<06:02,  3.70s/it]  3%|▎         | 3/100 [00:10<05:38,  3.49s/it]                                                 3%|▎         | 3/100 [00:10<05:38,  3.49s/it]  4%|▍         | 4/100 [00:14<05:24,  3.38s/it]                                                 4%|▍         | 4/100 [00:14<05:24,  3.38s/it]  5%|▌         | 5/100 [00:17<05:13,  3.30s/it]                                                 5%|▌         | 5/100 [00:17<05:13,  3.30s/it]  6%|▌         | 6/100 [00:20<05:08,  3.28s/it]                                                 6%|▌         | 6/100 [00:20<05:08,  3.28s/it]  7%|▋         | 7/100 [00:23<05:01,  3.24s/it]                                                 7%|▋         | 7/100 [00:23<05:01,  3.24s/it]  8%|▊         | 8/100 [00:26<04:58,  3.24s/it]                                                 8%|▊         | 8/100 [00:26<04:58,  3.24s/it]  9%|▉         | 9/100 [00:29<04:49,  3.18s/it]                                                 9%|▉         | 9/100 [00:30<04:49,  3.18s/it] 10%|█         | 10/100 [00:33<04:46,  3.18s/it]                                                 10%|█         | 10/100 [00:33<04:46,  3.18s/it] 11%|█         | 11/100 [00:36<04:43,  3.19s/it]                                                 11%|█         | 11/100 [00:36<04:43,  3.19s/it] 12%|█▏        | 12/100 [00:39<04:40,  3.19s/it]                                                 12%|█▏        | 12/100 [00:39<04:40,  3.19s/it] 13%|█▎        | 13/100 [00:42<04:39,  3.21s/it]                                                 13%|█▎        | 13/100 [00:42<04:39,  3.21s/it] 14%|█▍        | 14/100 [00:45<04:33,  3.18s/it]                                                 14%|█▍        | 14/100 [00:45<04:33,  3.18s/it] 15%|█▌        | 15/100 [00:49<04:29,  3.17s/it]                                                 15%|█▌        | 15/100 [00:49<04:29,  3.17s/it] 16%|█▌        | 16/100 [00:52<04:27,  3.18s/it]                                                 16%|█▌        | 16/100 [00:52<04:27,  3.18s/it] 17%|█▋        | 17/100 [00:55<04:22,  3.16s/it]                                                 17%|█▋        | 17/100 [00:55<04:22,  3.16s/it] 18%|█▊        | 18/100 [00:58<04:19,  3.17s/it]                                                 18%|█▊        | 18/100 [00:58<04:19,  3.17s/it] 19%|█▉        | 19/100 [01:01<04:15,  3.16s/it]                                                 19%|█▉        | 19/100 [01:01<04:15,  3.16s/it] 20%|██        | 20/100 [01:04<04:12,  3.16s/it]                                                 20%|██        | 20/100 [01:04<04:12,  3.16s/it] 21%|██        | 21/100 [01:08<04:11,  3.18s/it]                                                 21%|██        | 21/100 [01:08<04:11,  3.18s/it] 22%|██▏       | 22/100 [01:11<04:08,  3.19s/it]                                                 22%|██▏       | 22/100 [01:11<04:08,  3.19s/it] 23%|██▎       | 23/100 [01:14<04:06,  3.20s/it]                                                 23%|██▎       | 23/100 [01:14<04:06,  3.20s/it] 24%|██▍       | 24/100 [01:17<04:03,  3.21s/it]                                                 24%|██▍       | 24/100 [01:17<04:03,  3.21s/it] 25%|██▌       | 25/100 [01:20<04:00,  3.20s/it]                                                 25%|██▌       | 25/100 [01:21<04:00,  3.20s/it] 26%|██▌       | 26/100 [01:24<03:57,  3.21s/it]                                                 26%|██▌       | 26/100 [01:24<03:57,  3.21s/it] 27%|██▋       | 27/100 [01:27<03:51,  3.17s/it]                                                 27%|██▋       | 27/100 [01:27<03:51,  3.17s/it] 28%|██▊       | 28/100 [01:30<03:47,  3.16s/it]                                                 28%|██▊       | 28/100 [01:30<03:47,  3.16s/it] 29%|██▉       | 29/100 [01:33<03:46,  3.19s/it]                                                 29%|██▉       | 29/100 [01:33<03:46,  3.19s/it] 30%|███       | 30/100 [01:36<03:44,  3.21s/it]                                                 30%|███       | 30/100 [01:37<03:44,  3.21s/it] 31%|███       | 31/100 [01:40<03:41,  3.20s/it]                                                 31%|███       | 31/100 [01:40<03:41,  3.20s/it] 32%|███▏      | 32/100 [01:43<03:36,  3.18s/it]                                                 32%|███▏      | 32/100 [01:43<03:36,  3.18s/it] 33%|███▎      | 33/100 [01:46<03:32,  3.17s/it]                                                 33%|███▎      | 33/100 [01:46<03:32,  3.17s/it] 34%|███▍      | 34/100 [01:49<03:28,  3.16s/it]                                                 34%|███▍      | 34/100 [01:49<03:28,  3.16s/it] 35%|███▌      | 35/100 [01:52<03:25,  3.16s/it]                                                 35%|███▌      | 35/100 [01:52<03:25,  3.16s/it] 36%|███▌      | 36/100 [01:55<03:20,  3.14s/it]                                                 36%|███▌      | 36/100 [01:55<03:20,  3.14s/it] 37%|███▋      | 37/100 [01:58<03:18,  3.15s/it]                                                 37%|███▋      | 37/100 [01:59<03:18,  3.15s/it] 38%|███▊      | 38/100 [02:02<03:14,  3.14s/it]                                                 38%|███▊      | 38/100 [02:02<03:14,  3.14s/it] 39%|███▉      | 39/100 [02:05<03:11,  3.13s/it]                                                 39%|███▉      | 39/100 [02:05<03:11,  3.13s/it] 40%|████      | 40/100 [02:08<03:10,  3.17s/it]                                                 40%|████      | 40/100 [02:08<03:10,  3.17s/it] 41%|████      | 41/100 [02:11<03:05,  3.15s/it]                                                 41%|████      | 41/100 [02:11<03:05,  3.15s/it] 42%|████▏     | 42/100 [02:14<03:02,  3.15s/it]                                                 42%|████▏     | 42/100 [02:14<03:02,  3.15s/it] 43%|████▎     | 43/100 [02:17<03:00,  3.16s/it]                                                 43%|████▎     | 43/100 [02:17<03:00,  3.16s/it] 44%|████▍     | 44/100 [02:21<02:56,  3.15s/it]                                                 44%|████▍     | 44/100 [02:21<02:56,  3.15s/it] 45%|████▌     | 45/100 [02:24<02:54,  3.17s/it]                                                 45%|████▌     | 45/100 [02:24<02:54,  3.17s/it] 46%|████▌     | 46/100 [02:27<02:52,  3.19s/it]                                                 46%|████▌     | 46/100 [02:27<02:52,  3.19s/it] 47%|████▋     | 47/100 [02:30<02:48,  3.18s/it]                                                 47%|████▋     | 47/100 [02:30<02:48,  3.18s/it] 48%|████▊     | 48/100 [02:33<02:44,  3.17s/it]                                                 48%|████▊     | 48/100 [02:33<02:44,  3.17s/it] 49%|████▉     | 49/100 [02:36<02:41,  3.16s/it]                                                 49%|████▉     | 49/100 [02:36<02:41,  3.16s/it] 50%|█████     | 50/100 [02:40<02:37,  3.16s/it]                                                 50%|█████     | 50/100 [02:40<02:37,  3.16s/it] 51%|█████     | 51/100 [02:43<02:34,  3.15s/it]                                                 51%|█████     | 51/100 [02:43<02:34,  3.15s/it] 52%|█████▏    | 52/100 [02:46<02:31,  3.15s/it]                                                 52%|█████▏    | 52/100 [02:46<02:31,  3.15s/it] 53%|█████▎    | 53/100 [02:49<02:28,  3.16s/it]                                                 53%|█████▎    | 53/100 [02:49<02:28,  3.16s/it] 54%|█████▍    | 54/100 [02:52<02:25,  3.16s/it]                                                 54%|█████▍    | 54/100 [02:52<02:25,  3.16s/it] 55%|█████▌    | 55/100 [02:55<02:22,  3.16s/it]                                                 55%|█████▌    | 55/100 [02:55<02:22,  3.16s/it] 56%|█████▌    | 56/100 [02:58<02:18,  3.15s/it]                                                 56%|█████▌    | 56/100 [02:59<02:18,  3.15s/it] 57%|█████▋    | 57/100 [03:02<02:15,  3.15s/it]                                                 57%|█████▋    | 57/100 [03:02<02:15,  3.15s/it] 58%|█████▊    | 58/100 [03:05<02:11,  3.14s/it]                                                 58%|█████▊    | 58/100 [03:05<02:11,  3.14s/it] 59%|█████▉    | 59/100 [03:08<02:09,  3.15s/it]                                                 59%|█████▉    | 59/100 [03:08<02:09,  3.15s/it] 60%|██████    | 60/100 [03:11<02:05,  3.14s/it]                                                 60%|██████    | 60/100 [03:11<02:05,  3.14s/it] 61%|██████    | 61/100 [03:14<02:03,  3.17s/it]                                                 61%|██████    | 61/100 [03:14<02:03,  3.17s/it] 62%|██████▏   | 62/100 [03:17<02:00,  3.16s/it]                                                 62%|██████▏   | 62/100 [03:17<02:00,  3.16s/it] 63%|██████▎   | 63/100 [03:21<01:57,  3.17s/it]                                                 63%|██████▎   | 63/100 [03:21<01:57,  3.17s/it] 64%|██████▍   | 64/100 [03:24<01:54,  3.18s/it]                                                 64%|██████▍   | 64/100 [03:24<01:54,  3.18s/it] 65%|██████▌   | 65/100 [03:27<01:51,  3.18s/it]                                                 65%|██████▌   | 65/100 [03:27<01:51,  3.18s/it] 66%|██████▌   | 66/100 [03:30<01:47,  3.17s/it]                                                 66%|██████▌   | 66/100 [03:30<01:47,  3.17s/it] 67%|██████▋   | 67/100 [03:33<01:44,  3.16s/it]                                                 67%|██████▋   | 67/100 [03:33<01:44,  3.16s/it] 68%|██████▊   | 68/100 [03:36<01:41,  3.16s/it]                                                 68%|██████▊   | 68/100 [03:36<01:41,  3.16s/it] 69%|██████▉   | 69/100 [03:40<01:38,  3.18s/it]                                                 69%|██████▉   | 69/100 [03:40<01:38,  3.18s/it] 70%|███████   | 70/100 [03:43<01:34,  3.16s/it]                                                 70%|███████   | 70/100 [03:43<01:34,  3.16s/it] 71%|███████   | 71/100 [03:46<01:31,  3.15s/it]                                                 71%|███████   | 71/100 [03:46<01:31,  3.15s/it] 72%|███████▏  | 72/100 [03:49<01:28,  3.16s/it]                                                 72%|███████▏  | 72/100 [03:49<01:28,  3.16s/it] 73%|███████▎  | 73/100 [03:52<01:25,  3.18s/it]                                                 73%|███████▎  | 73/100 [03:52<01:25,  3.18s/it] 74%|███████▍  | 74/100 [03:55<01:22,  3.18s/it]                                                 74%|███████▍  | 74/100 [03:56<01:22,  3.18s/it] 75%|███████▌  | 75/100 [03:59<01:18,  3.15s/it]                                                 75%|███████▌  | 75/100 [03:59<01:18,  3.15s/it] 76%|███████▌  | 76/100 [04:02<01:15,  3.14s/it]                                                 76%|███████▌  | 76/100 [04:02<01:15,  3.14s/it] 77%|███████▋  | 77/100 [04:05<01:12,  3.14s/it]                                                 77%|███████▋  | 77/100 [04:05<01:12,  3.14s/it] 78%|███████▊  | 78/100 [04:08<01:08,  3.13s/it]                                                 78%|███████▊  | 78/100 [04:08<01:08,  3.13s/it] 79%|███████▉  | 79/100 [04:11<01:06,  3.15s/it]                                                 79%|███████▉  | 79/100 [04:11<01:06,  3.15s/it] 80%|████████  | 80/100 [04:14<01:02,  3.15s/it]                                                 80%|████████  | 80/100 [04:14<01:02,  3.15s/it]